---
title: PointNet++(NeurlIPS '17) Review
categories:
- Papers
tags:
- Point Cloud
- NeurlIPS
toc: true
toc_sticky: true
toc_label: On this Page
last_modified_at: 2021-09-27T03:33:30+08:00
---

지난번에 이어 PointNet의 후속논문인 PoitNet++ 정리자료를 가지고 와봤다. 이 논문 역시 정리한지 꽤 지나긴 했는데 Point cloud논문의 기초중에 기초라 꼭 추가해야 할 것 같았다. 기존 PointNet과의 가장 큰 차이는 PointNet의 method에 Hierarchical한 구조를 추가했다는 점이다.

# Intro
___
풀고자 하는 Task는 기존과 동일하게 Euclidean space상의 set of point들을 분석 하는 것이다.

PointNet의 main idea는 pointwise로 feature를(MLP를 통해) 생성한뒤  aggregation을 통하여 global feature을 계산하여 문제를 해결하였다. 하지만 이로인해 Local structure를 고려하지 않는 문제가 발생!

CNN과 같은 기존의 연구들을 통하여 local한 정보의 중요성을 쉽게 알 수 있기에, 본 논문에서도 hierarchical한 구조를 통하여 모델 초기에는 좁은 receptive field부터 최종적으로 global한 receptive field를 고려할 수 있게끔 모델을 설계하였다.

이를 위해, 전체 Set of points 들을 subset으로 쪼갠후, subset들 끼리의 feature를 파악(local neighborhood)이렇게 생성된 point들을 다시 subset으로 묶고 feature 계산 반복 최종적으로 global feature 생성하게끔 모델을 구현하였다고한다.
단, subset 생성을 위해서 진행되는 sampling과 grouping의 경우 overlapping 가능(하나의 point가 여러 subset에 속할수 있음, faster-rcnn에서 하나의 pixel이 여러 kernel에 속하는 것과 비슷한 느낌)

# Main
___
**PointNet**

Formulation : f(x_1,x_2,...,x_n) = \gamma(\max_{i=1,...,n}\{h(x_i)\})
Formulation만 보면 기존의 PointNet과의 큰 차이는 없어보인다. Pointwise feature 생성도 그렇고, symmetric function도 그렇고... 하지만 앞서 말했다 시피 PointNet++의 가장 큰 차이는 모델 구조의 차이다.

**Hierarchical Point Set Feature Learning**
![fig](/assets/images/posts/PointNet2-fig1.png){: .open-new width="100%" height="100%"}  
그림을 보다시피 모델의 구조는 subset  생성과 Pointnet 적용의 반복으로 구성되어 잇으며, overlapping partitioning은 2d상에서의 kernel과 유사하다고 생각할 수 있다.  
*Set Abstraction = sampling + grouping + pointNet* 

모델의 구성요소를 하나씩 설명하자면 다음과 같다.
1. Sampling layer: iterative farthest point sampling(FPS)방식을 통해서 input point로 부터 sampling을 진행(Down-sampling)
2. Grouping layer: centroid location으로부터 일정 radious 있는 모든 점들을 grouping.  
NxD → N' x K x D의 data로 변환, N'는 Sampling된 point들의 갯수이며, K는 sampling된 포인트를 기준으로 그룹안에 들어있는 point들의 수로 group에따라 K의 수가 다를수도 있다.
3. PointNet layer: N' x K x D의 data로부터 PointNet을 진행하여 N'XD'의 local feature 생성.  
본 논문에서는 D가 (x,y,z)좌표 + feature로 구성되어 있음


**Structure**


T-Net:Transformation network (input으로 부터 KxK의 transformation network 생성)  
T-Net structure : (SFCN(64) -> SFCN(128) -> SFCN(1024) -> MaxPool -> FCN(512) -> FCN(256) -> Linear(K\*K))  
mlp : multi layer perceptron(FC layer와 Relu로 구성)  

**Symmetry Function for Unordered Input**

가능한 접근법은 다음과 같다.  
1. 정렬, 2. input을 sequence로 여겨 RNN적용, **3. Symmetric function을 사용하여 point aggregation**

본 논문에서는 3번채용, 다음과 같은 방식으로 계산  
$f(\{x_1,...,x_n\}) \approx g(h(x_1),...,h(x_n))$  
각 $x_i$는 point들의 feature이며, $h()$는 MLP, $g$는 Max pooling을 의미한다.

**Local and Global Information Aggregation**

위에서 나온 결과를 FC layer를 통하여 바로 classification 진행가능  
하지만 segmentation의 경우, point-wise의 input이 필요함  
이를 위해 Pointwise의 feature(local한 정보)와 앞서 max pooling을 통해 나온 feature(global)정보를 결합하여 각 point 별로 segmentation 진행

**Joint Alignment Network**

Translation에 영향을 받지 않기위해선 model에 집어 넣기전에 Input Point Set의 정규화가 필요하다., 이를 위해 Input을 정규화 할수 있는 transformation matrix가 필요
mini-network(위의 T-net)을 통하여 input으로 부터 정규화를 시킬 수 있는 transformation matrix 생성하게된다.

# 마치며
___
PointNet은 요즘 나오는 논문들에 비하면 성능은 크게 떨어지지만 최초로 PointCloud를 딥러닝을 통해 풀려고 한 논문이다 보니 큰 의미가 있는것 같다.
정리한지 꽤 지난 논문이기도 하고 대학원에 입학도 전에 정리해놔서 그런지 부족한 부분이 많아 아쉬움이 남는다. 지금도 그렇지만 당시에는 좀더 Method에 치우쳐서 논문을 읽었던것 같다.
그래서 그런지 Experiment 부분에 대한 설명도 하나도 없네.. 다음번에는 PointNet의 발전버전인 PointNet++을 리뷰해보도록 하겠다.

**References**

https://arxiv.org/pdf/1706.02413.pdf
[https://goodgodgd.github.io/ian-flow/archivers/segmentation-survey](https://goodgodgd.github.io/ian-flow/archivers/segmentation-survey)
